<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UrbanFlow2 - Government of India AI Logistics Optimization Platform</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Government Header -->
    <header class="govt-header">
        <div class="container">
            <div class="govt-header-content">
                <div class="govt-logo">
                    <div class="emblem">üáÆüá≥</div>
                    <div class="govt-text">
                        <h1 class="govt-title">UrbanFlow2</h1>
                        <span class="govt-subtitle">‡§≠‡§æ‡§∞‡§§ ‡§∏‡§∞‡§ï‡§æ‡§∞ - Government of India</span>
                        <span class="system-name">AI Logistics Optimization Platform</span>
                    </div>
                </div>
                <div class="govt-actions">
                     <div class="language-selector">
        <button class="btn btn--govt btn--lg" onclick="toggleLanguageMenu()">üåç Language</button>
        <div id="languageMenu" class="language-menu hidden">
            <a href="#" onclick="selectLanguage('english')">English</a>
            <a href="#" onclick="selectLanguage('hindi')">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</a>
        </div>
    </div>
    <button class="btn btn--govt btn--lg" onclick="downloadSampleData()">üìã Download Templates</button>
    <button class="btn btn--govt btn--lg" onclick="toggleDemoMode()" id="demoBtn">üéÆ Demo Mode</button>
    <button class="btn btn--govt btn--lg" onclick="resetSystem()">üîÑ Reset</button>
    <button class="btn btn--govt btn--lg" onclick="exportResults()" id="exportBtn" disabled>üìä Export</button>
</div>
            </div>
        </div>
    </header>

    <!-- Main Dashboard -->
    <main class="govt-dashboard">
        <div class="container">
            
            <!-- Workflow Progress -->
            <div class="workflow-section card govt-card">
                <div class="card__header govt-card-header">
                    <h2>üìã Data-Driven Optimization Workflow</h2>
                </div>
                <div class="card__body">
                    <div class="workflow-steps">
                        <div class="workflow-step active" data-step="1">
                            <div class="step-indicator">1</div>
                            <div class="step-content">
                                <h4>Upload Datasets</h4>
                                <p>Upload 6 CSV files with coordinates</p>
                            </div>
                        </div>
                        <div class="workflow-step" data-step="2">
                            <div class="step-indicator">2</div>
                            <div class="step-content">
                                <h4>Validation</h4>
                                <p>Validate data integrity</p>
                            </div>
                        </div>
                        <div class="workflow-step" data-step="3">
                            <div class="step-indicator">3</div>
                            <div class="step-content">
                                <h4>Map Visualization</h4>
                                <p>View real locations</p>
                            </div>
                        </div>
                        <div class="workflow-step" data-step="4">
                            <div class="step-indicator">4</div>
                            <div class="step-content">
                                <h4>Run Optimization</h4>
                                <p>AI algorithm processing</p>
                            </div>
                        </div>
                        <div class="workflow-step" data-step="5">
                            <div class="step-indicator">5</div>
                            <div class="step-content">
                                <h4>Results & Analysis</h4>
                                <p>View optimized solutions</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Upload Section -->
            <div class="upload-section card govt-card">
                <div class="card__header govt-card-header">
                    <h3>üìÅ Dataset Upload & Validation</h3>
                    <div class="upload-status">
                        <div class="status-display">
                            <span class="status-text" id="uploadStatus">Upload datasets to proceed</span>
                            <div class="validation-circle" id="validationProgress">
                                <span class="progress-text" id="progressText">0/6</span>
                            </div>
                        </div>
                        <button class="btn btn--govt btn--lg" id="optimizeBtn" onclick="runOptimization()" disabled>
                            üöÄ Run Optimization
                        </button>
                    </div>
                </div>
                <div class="card__body">
                    <div class="validation-summary-empty" id="validationSummaryEmpty">
                        <div class="empty-state">
                            <div class="empty-icon">üó∫Ô∏è</div>
                            <h4>Upload Real Data Required</h4>
                            <p>Upload all 6 CSV files with actual coordinates. Interactive map with port ‚öì and plant üè≠ icons will appear after validation.</p>
                        </div>
                    </div>
                    
                    <div class="validation-summary hidden" id="validationSummary">
                        <div class="summary-grid">
                            <div class="summary-stat">
                                <span class="stat-label">Files:</span>
                                <span class="stat-value" id="filesUploaded">0/6</span>
                            </div>
                            <div class="summary-stat">
                                <span class="stat-label">Status:</span>
                                <span class="stat-value" id="validationStatus">Pending</span>
                            </div>
                            <div class="summary-stat">
                                <span class="stat-label">Records:</span>
                                <span class="stat-value" id="totalRecords">0</span>
                            </div>
                            <div class="summary-stat">
                                <span class="stat-label">Coordinates:</span>
                                <span class="stat-value" id="coordinatesFound">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="dataset-grid">
                        <div class="dataset-card" data-dataset="ports">
                            <div class="dataset-header">
                                <h4>‚öì ports.csv</h4>
                                <span class="dataset-status" id="ports-status">Not Uploaded</span>
                            </div>
                            <div class="dataset-schema">
                                <p><strong>Required:</strong> port_id, port_name, <strong>latitude, longitude</strong>, max_capacity_tons, handling_cost, storage_cost</p>
                            </div>
                            <div class="dataset-upload" onclick="triggerFileUpload('ports')">
                                <div class="upload-icon">‚öì</div>
                                <div class="upload-text">Drop CSV with coordinates</div>
                                <input type="file" class="file-input" accept=".csv" data-dataset="ports" style="display: none;">
                            </div>
                            <div class="validation-results hidden" id="ports-validation"></div>
                        </div>

                        <div class="dataset-card" data-dataset="plants">
                            <div class="dataset-header">
                                <h4>üè≠ plants.csv</h4>
                                <span class="dataset-status" id="plants-status">Not Uploaded</span>
                            </div>
                            <div class="dataset-schema">
                                <p><strong>Required:</strong> plant_id, plant_name, <strong>latitude, longitude</strong>, max_capacity_tons, required_material</p>
                            </div>
                            <div class="dataset-upload" onclick="triggerFileUpload('plants')">
                                <div class="upload-icon">üè≠</div>
                                <div class="upload-text">Drop CSV with coordinates</div>
                                <input type="file" class="file-input" accept=".csv" data-dataset="plants" style="display: none;">
                            </div>
                            <div class="validation-results hidden" id="plants-validation"></div>
                        </div>

                        <div class="dataset-card" data-dataset="vessels">
                            <div class="dataset-header">
                                <h4>üö¢ vessels.csv</h4>
                                <span class="dataset-status" id="vessels-status">Not Uploaded</span>
                            </div>
                            <div class="dataset-schema">
                                <p><strong>Required:</strong> vessel_id, vessel_name, capacity_tons, eta_date, origin_port, demurrage_rate</p>
                            </div>
                            <div class="dataset-upload" onclick="triggerFileUpload('vessels')">
                                <div class="upload-icon">üö¢</div>
                                <div class="upload-text">Drop vessel CSV</div>
                                <input type="file" class="file-input" accept=".csv" data-dataset="vessels" style="display: none;">
                            </div>
                            <div class="validation-results hidden" id="vessels-validation"></div>
                        </div>

                        <div class="dataset-card" data-dataset="routes">
                            <div class="dataset-header">
                                <h4>üõ£Ô∏è routes.csv</h4>
                                <span class="dataset-status" id="routes-status">Not Uploaded</span>
                            </div>
                            <div class="dataset-schema">
                                <p><strong>Required:</strong> route_id, from_port_id, to_plant_id, rail_cost, travel_days, capacity_limit</p>
                            </div>
                            <div class="dataset-upload" onclick="triggerFileUpload('routes')">
                                <div class="upload-icon">üõ£Ô∏è</div>
                                <div class="upload-text">Drop route CSV</div>
                                <input type="file" class="file-input" accept=".csv" data-dataset="routes" style="display: none;">
                            </div>
                            <div class="validation-results hidden" id="routes-validation"></div>
                        </div>

                        <div class="dataset-card" data-dataset="costs">
                            <div class="dataset-header">
                                <h4>üí∞ costs.csv</h4>
                                <span class="dataset-status" id="costs-status">Not Uploaded</span>
                            </div>
                            <div class="dataset-schema">
                                <p><strong>Required:</strong> cost_type, port_id, value_per_ton, currency</p>
                            </div>
                            <div class="dataset-upload" onclick="triggerFileUpload('costs')">
                                <div class="upload-icon">üí∞</div>
                                <div class="upload-text">Drop cost CSV</div>
                                <input type="file" class="file-input" accept=".csv" data-dataset="costs" style="display: none;">
                            </div>
                            <div class="validation-results hidden" id="costs-validation"></div>
                        </div>

                        <div class="dataset-card" data-dataset="delays">
                            <div class="dataset-header">
                                <h4>‚è∞ delays.csv</h4>
                                <span class="dataset-status" id="delays-status">Not Uploaded</span>
                            </div>
                            <div class="dataset-schema">
                                <p><strong>Required:</strong> port_id, historical_eta, actual_arrival, weather, congestion_level, delay_hours</p>
                            </div>
                            <div class="dataset-upload" onclick="triggerFileUpload('delays')">
                                <div class="upload-icon">‚è∞</div>
                                <div class="upload-text">Drop delay CSV</div>
                                <input type="file" class="file-input" accept=".csv" data-dataset="delays" style="display: none;">
                            </div>
                            <div class="validation-results hidden" id="delays-validation"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Interactive Map Section -->
            <div class="map-section card govt-card hidden" id="mapSection">
                <div class="card__header govt-card-header">
                    <h3>üó∫Ô∏è Interactive Map - Real Locations</h3>
                    <div class="map-stats" id="mapStats">
                        <span class="map-stat">‚öì Ports: <strong id="portCount">0</strong></span>
                        <span class="map-stat">üè≠ Plants: <strong id="plantCount">0</strong></span>
                        <span class="map-stat">üõ£Ô∏è Routes: <strong id="routeCount">0</strong></span>
                    </div>
                </div>
                <div class="card__body">
                    <div class="map-container" id="mapContainer" style="height: 400px; width: 100%; position: relative;">
                        <!-- Interactive map with specific port and plant icons -->
                    </div>
                </div>
            </div>

            <!-- Algorithm Processing Monitor -->
            <div class="processing-section card govt-card hidden" id="processingSection">
                <div class="card__header govt-card-header">
                    <h3>‚ö° AI Algorithm Processing</h3>
                    <div class="processing-status">
                        <span class="status status--warning pulse" id="processingStatusText">Processing your data...</span>
                    </div>
                </div>
                <div class="card__body">
                    <div class="algorithm-phases">
                        <div class="algorithm-phase" id="phase-gnn">
                            <div class="phase-icon">üß†</div>
                            <div class="phase-content">
                                <h4>GNN Predictions</h4>
                                <p>Analyzing delay patterns from your data</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="gnn-progress"></div>
                                </div>
                            </div>
                        </div>
                        <div class="algorithm-phase" id="phase-ga">
                            <div class="phase-icon">üß¨</div>
                            <div class="phase-content">
                                <h4>Genetic Algorithm</h4>
                                <p>Optimizing vessel assignments</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="ga-progress"></div>
                                </div>
                            </div>
                        </div>
                        <div class="algorithm-phase" id="phase-alns">
                            <div class="phase-icon">üîß</div>
                            <div class="phase-content">
                                <h4>ALNS Refinement</h4>
                                <p>Improving solution quality</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="alns-progress"></div>
                                </div>
                            </div>
                        </div>
                        <div class="algorithm-phase" id="phase-tabu">
                            <div class="phase-icon">üéØ</div>
                            <div class="phase-content">
                                <h4>Tabu Search</h4>
                                <p>Final optimization polish</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="tabu-progress"></div>
                                </div>
                            </div>
                        </div>
                        <div class="algorithm-phase" id="phase-performance">
                            <div class="phase-icon">üìà</div>
                            <div class="phase-content">
                                <h4>Performance</h4>
                                <p>Calculating final metrics</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="performance-progress"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Empty Results State -->
            <div class="empty-results card govt-card" id="emptyResults">
                <div class="card__body">
                    <div class="empty-state">
                        <div class="empty-icon">üìä</div>
                        <h3>No Results Available</h3>
                        <p>Upload your datasets and run optimization to see data-driven results with interactive scenario testing.</p>
                    </div>
                </div>
            </div>

            <!-- Optimized Vessel Schedule & Cost Analysis -->
            <div class="results-section card govt-card hidden" id="resultsSection">
                <div class="card__header govt-card-header">
                    <h3>üéØ Optimized Vessel Schedule & Cost Analysis</h3>
                    <div class="results-actions">
                        <button class="btn btn--outline btn--sm" onclick="generateReport()">üìä Generate Report</button>
                        <button class="btn btn--outline btn--sm" onclick="showAuditTrail()">üìã Full Audit Trail</button>
                        <button class="btn btn--primary btn--sm" onclick="exportResults()">üìÑ Detailed Export</button>
                    </div>
                </div>
                <div class="card__body">
                    <div class="schedule-container">
                        <div class="table-container">
                            <table class="schedule-table" id="scheduleTable">
                                <thead>
                                    <tr>
                                        <th>Vessel ID</th>
                                        <th>Vessel Name</th>
                                        <th>ETA</th>
                                        <th>Discharge Port</th>
                                        <th>Port Delay (GNN)</th>
                                        <th>Assigned Plant</th>
                                        <th>Quantity (Tons)</th>
                                        <th>Total Cost (‚Çπ)</th>
                                        <th>Cost Breakdown</th>
                                        <th>Feasibility</th>
                                    </tr>
                                </thead>
                                <tbody id="scheduleTableBody">
                                    <!-- Data populated from optimization results -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- What-If Scenario Simulator -->
            <div class="scenario-section card govt-card hidden" id="scenarioSection">
                <div class="card__header govt-card-header">
                    <h3>üéõÔ∏è Real-time Scenario Testing & Cost Impact Analysis</h3>
                    <div class="scenario-controls">
                        <button class="btn btn--outline btn--sm" onclick="resetScenarios()">üîÑ Reset Scenarios</button>
                        <button class="btn btn--primary btn--sm" onclick="saveScenario()">üíæ Save Scenario</button>
                    </div>
                </div>
                <div class="card__body">
                    <div class="scenario-grid">
                        <div class="scenario-sliders">
                            <div class="slider-group">
                                <label for="portDelayFactor">Port Delay Factor</label>
                                <input type="range" id="portDelayFactor" min="0.5" max="2.0" step="0.1" value="1.0" oninput="updateScenario()">
                                <span class="slider-value" id="portDelayValue">1.0x</span>
                            </div>
                            <div class="slider-group">
                                <label for="demandSurge">Demand Surge</label>
                                <input type="range" id="demandSurge" min="0.8" max="1.5" step="0.1" value="1.0" oninput="updateScenario()">
                                <span class="slider-value" id="demandSurgeValue">1.0x</span>
                            </div>
                            <div class="slider-group">
                                <label for="fuelCostVariation">Fuel Cost Variation</label>
                                <input type="range" id="fuelCostVariation" min="0.7" max="1.4" step="0.1" value="1.0" oninput="updateScenario()">
                                <span class="slider-value" id="fuelCostValue">1.0x</span>
                            </div>
                            <div class="slider-group">
                                <label for="weatherImpact">Weather Impact</label>
                                <input type="range" id="weatherImpact" min="0.9" max="1.3" step="0.1" value="1.0" oninput="updateScenario()">
                                <span class="slider-value" id="weatherImpactValue">1.0x</span>
                            </div>
                        </div>
                        <div class="scenario-impact">
                            <h4>Scenario Cost Impact Analysis</h4>
                            <div class="impact-metrics">
                                <div class="impact-card">
                                    <div class="impact-icon">üí∞</div>
                                    <div class="impact-content">
                                        <h5>Total Cost Impact</h5>
                                        <div class="impact-value" id="totalCostImpact">+0%</div>
                                    </div>
                                </div>
                                <div class="impact-card">
                                    <div class="impact-icon">üöö</div>
                                    <div class="impact-content">
                                        <h5>Delivery Impact</h5>
                                        <div class="impact-value" id="deliveryImpact">+0 days</div>
                                    </div>
                                </div>
                                <div class="impact-card">
                                    <div class="impact-icon">‚ö°</div>
                                    <div class="impact-content">
                                        <h5>Efficiency Impact</h5>
                                        <div class="impact-value" id="efficiencyImpact">100%</div>
                                    </div>
                                </div>
                                <div class="impact-card">
                                    <div class="impact-icon">üåç</div>
                                    <div class="impact-content">
                                        <h5>Environmental Impact</h5>
                                        <div class="impact-value" id="environmentalImpact">0%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- KPI Dashboard -->
            <div class="kpi-section card govt-card hidden" id="kpiSection">
                <div class="card__header govt-card-header">
                    <h3>üìä Performance Dashboard</h3>
                </div>
                <div class="card__body">
                    <div class="kpi-grid">
                        <div class="kpi-card">
                            <div class="kpi-icon">üí∞</div>
                            <div class="kpi-content">
                                <h5>Total Cost</h5>
                                <div class="kpi-value" id="totalCostKPI">‚Çπ0</div>
                                <div class="kpi-change">From data analysis</div>
                            </div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-icon">‚ö°</div>
                            <div class="kpi-content">
                                <h5>Capacity Utilization</h5>
                                <div class="kpi-value" id="capacityKPI">0%</div>
                                <div class="kpi-change">Port efficiency</div>
                            </div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-icon">‚è±Ô∏è</div>
                            <div class="kpi-content">
                                <h5>Average Delays</h5>
                                <div class="kpi-value" id="delayKPI">0 hrs</div>
                                <div class="kpi-change">GNN predictions</div>
                            </div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-icon">üö¢</div>
                            <div class="kpi-content">
                                <h5>Active Vessels</h5>
                                <div class="kpi-value" id="vesselKPI">0</div>
                                <div class="kpi-change">Currently optimized</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- Demo Mode Overlay -->
    <div class="demo-overlay hidden" id="demoOverlay">
        <div class="demo-content">
            <h3>üéÆ Demo Mode Active</h3>
            <p>Showing sample data and results for demonstration purposes.</p>
            <button class="btn btn--primary" onclick="toggleDemoMode()">Exit Demo Mode</button>
        </div>
    </div>

    <!-- Audit Trail Modal -->
    <div class="modal hidden" id="auditModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìã Full Audit Trail</h3>
                <button class="modal-close" onclick="closeModal('auditModal')">&times;</button>
            </div>
            <div class="modal-body" id="auditTrailContent">
                <!-- Audit trail content will be populated here -->
            </div>
        </div>
    </div>

    <!-- Report Generation Modal -->
    <div class="modal hidden" id="reportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìä Generate Report</h3>
                <button class="modal-close" onclick="closeModal('reportModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="report-options">
                    <div class="option-group">
                        <h4>Report Type</h4>
                        <label><input type="radio" name="reportType" value="summary" checked> Executive Summary</label>
                        <label><input type="radio" name="reportType" value="detailed"> Detailed Analysis</label>
                        <label><input type="radio" name="reportType" value="technical"> Technical Report</label>
                    </div>
                    <div class="option-group">
                        <h4>Include Sections</h4>
                        <label><input type="checkbox" checked> Optimization Results</label>
                        <label><input type="checkbox" checked> Cost Analysis</label>
                        <label><input type="checkbox" checked> Performance Metrics</label>
                        <label><input type="checkbox"> Scenario Analysis</label>
                        <label><input type="checkbox"> Audit Trail</label>
                    </div>
                    <button class="btn btn--govt btn--full-width" onclick="downloadReport()">üìÑ Download Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifications -->
    <div class="notification-container">
        <div class="notification hidden" id="notification">
            <div class="notification-icon" id="notificationIcon"></div>
            <div class="notification-content">
                <div class="notification-title" id="notificationTitle"></div>
                <div class="notification-message" id="notificationMessage"></div>
            </div>
            <button class="notification-close" onclick="hideNotification()">&times;</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>